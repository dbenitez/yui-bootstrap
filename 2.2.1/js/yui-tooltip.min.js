(function(){var d=YAHOO.util.Dom,e=YAHOO.lang,b=YAHOO.util.Event,a=YAHOO.util.Selector,c=function(g,f){this.init("tooltip",g,f);d.setData(this.$element,this.type,this)};c.prototype={constructor:c,defaults:{animation:true,placement:"top",selector:false,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0,html:true},init:function(j,i,h){var k,g;this.type=j;this.$element=d.get(i);this.options=this.getOptions(h);this.enabled=true;if(this.options.trigger=="click"){var f=a.query(this.options.selector,this.$element);if(!f.length){f=this.$element}b.addListener(f,"click",this.toggle,this,true)}else{if(this.options.trigger!="manual"){k=this.options.trigger=="hover"?"mouseenter":"focus";g=this.options.trigger=="hover"?"mouseleave":"blur";var f=a.query(this.options.selector,this.$element);if(!f.length){f=this.$element}b.addListener(f,k,this.enter,this,true);b.addListener(f,g,this.leave,this,true)}}this.options.selector?(this._options=e.merge({},this.options,{trigger:"manual",selector:""})):this.fixTitle()},getOptions:function(f){f=e.merge({},this.defaults,f||{},d.getData(this.$element));if(f.delay&&typeof f.delay=="number"){f.delay={show:f.delay,hide:f.delay}}return f},enter:function(h){var f=d.getData(h.currentTarget,this.type);var g=this.type.charAt(0).toUpperCase()+this.type.substr(1);if(!f){f=new YAHOO.bootstrap[g](h.currentTarget,this._options)}if(!f.options.delay||!f.options.delay.show){return f.show()}clearTimeout(this.timeout);f.hoverState="in";this.timeout=setTimeout(function(){if(f.hoverState=="in"){f.show()}},f.options.delay.show)},leave:function(g){var f=d.getData(g.currentTarget,this.type);if(!f){f=new YAHOO.bootstrap[this.type.charAt(0).toUpperCase()+this.type.substr(1)](this._options)}if(this.timeout){clearTimeout(this.timeout)}if(!f.options.delay||!f.options.delay.hide){return f.hide()}f.hoverState="out";this.timeout=setTimeout(function(){if(f.hoverState=="out"){f.hide()}},f.options.delay.hide)},show:function(){var j,f,l,h,k,g,i={top:0,left:0};if(this.hasContent()&&this.enabled){j=this.tip();this.setContent();if(this.options.animation){d.addClass(j,"fade")}g=typeof this.options.placement=="function"?this.options.placement.call(this,j,this.$element):this.options.placement;f=/in/.test(g);this._remove(j);d.setStyle(j,"top",0);d.setStyle(j,"left",0);d.setStyle(j,"display","block");f?this.$element.appendChild(j):document.body.appendChild(j);l=this.getPosition(f);h=j.offsetWidth;k=j.offsetHeight;switch(f?g.split(" ")[1]:g){case"bottom":i={top:l.top+l.height,left:l.left+l.width/2-h/2};break;case"top":i={top:l.top-k,left:l.left+l.width/2-h/2};break;case"left":i={top:l.top+l.height/2-k/2,left:l.left-h};break;case"right":i={top:l.top+l.height/2-k/2,left:l.left+l.width};break}d.setXY(j,[i.left,i.top]);d.addClass(j,g);d.addClass(j,"in")}},setContent:function(){var h=this.tip(),g=this.getTitle(),f;f=d.getElementsByClassName("tooltip-inner","div",h);f[0][this.options.html?"innerHTML":"text"]=g;d.removeClass(h,/(fade|in|top|bottom|left|right)/)},hide:function(){var f=this,g=this.tip();d.removeClass(g,"in");function h(){var i=setTimeout(function(){b.removeListener(g,YAHOO.bootstrap.transition.end);f._remove(g)});b.on(g,YAHOO.bootstrap.transition.end,function(){clearTimeout(i);this._remove(g)},this,true)}YAHOO.bootstrap.transition&&d.hasClass(this.$tip,"fade")?h():this._remove(g);return this},fixTitle:function(){var f=this.$element;if(f.getAttribute("title")||typeof(f.getAttribute("data-original-title"))!="string"){f.setAttribute("data-original-title",f.getAttribute("title")||"");f.removeAttribute("title")}},hasContent:function(){return this.getTitle()},getPosition:function(f){var g=d.getXY(this.$element);return e.merge({},(f?{top:0,left:0}:{top:g[1],left:g[0]}),{width:this.$element.offsetWidth,height:this.$element.offsetHeight})},getTitle:function(){var h,f=this.$element,g=this.options;h=f.getAttribute("data-original-title")||(typeof g.title=="function"?g.title.call(f):g.title);return h},tip:function(){return this.$tip=this.$tip||this._renderTemplate(this.options.template)},validate:function(){if(!this.$element.parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[d.hasClass(this.tip(),"in")?"hide":"show"]()},destroy:function(){var g,f;this.hide();if(this.options.trigger=="click"){b.removeListener(this.$element,"click")}else{if(this.options.trigger!="manual"){g=this.options.trigger=="hover"?"mouseenter":"focus";f=this.options.trigger=="hover"?"mouseleave":"blur";b.removeListener(this.$element,g);b.removeListener(this.$element,f)}}d.removeData(this.$element,this.type)},_remove:function(f){if(f.parentNode){f.parentNode.removeChild(f)}},_renderTemplate:function(f){var g=document.createElement("div");g.innerHTML=f;return g.firstChild}};YAHOO.bootstrap.Tooltip=c}());